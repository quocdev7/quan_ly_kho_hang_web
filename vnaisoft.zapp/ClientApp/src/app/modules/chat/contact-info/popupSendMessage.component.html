<div class="flex flex-col flex-auto h-full overflow-hidden bg-card dark:bg-default">
    <div class="flex flex-row justify-end space-x-2 pt-2 mb-4 mx-4">
        <button class="bg-primary-600 text-white shadow-none hover:bg-primary-700" mat-raised-button
            transloco="system.send"></button>
        <button class="bg-teal-500 text-white shadow-none hover:bg-teal-600" mat-raised-button (click)="close()"
            transloco="close"></button>
    </div>
    <div class="relative overflow-y-auto">
        
        <div class="relative px-3 py-2 mr-2 rounded-lg bg-gray-600 text-blue-50 ">
            <div class="min-w-4 leading-5">
                <!-- message text -->
                <div *ngIf="chat.status!=2 && chat.type_message==1  && chat.meta_tag==null">
                    <span>
                        {{chat.message}}
                    </span>
                </div>
                <!-- file -->
                <div
                    *ngIf="chat.status!=2 && chat.type_message==2 && chat.extensionFile=='pdf'">
                    <div class="flex flex-row w-50">
                        <div class="w-1/3 h-10 mr-2">
                            <!-- <img [src]="chat.filePath" alt=""> -->
                            <img class=" h-10"
                                [src]="'assets/images/whatsApp/Whatsapp-Wallpaper-2.jpg'"
                                alt="">
                        </div>
                        <div class="w-2/3">
                            <span>
                                {{chat.fileName}}
                            </span> <br>
                            <span>
                                {{formatSizeUnits(chat.fileSize)}}
                            </span>
                        </div>
                    </div>
                </div>
                <!-- image -->
                <div
                    *ngIf="chat.status!=2 && chat.type_message==2  && chat.extensionFile!='pdf'">
                    <img [src]="'assets/images/whatsApp/Whatsapp-Wallpaper-2.jpg'" alt="">
                    <!-- <img [src]="chat.filePath" alt=""> -->
                </div>
                <!-- map -->
                <div
                    *ngIf="chat.status!=2 && chat.type_message==5  && chat.extensionFile!=null">
                    <img [src]="'assets/images/whatsApp/Whatsapp-Wallpaper-2.jpg'" alt="">
                    <!-- <img [src]="chat.filePath" alt=""> -->
                </div>

                <!-- <div
                            *ngIf="chat.status!=2 && chat.type_message==5 || chat.status!=2 && chat.type_message==2">
                            <img  [src]="chat.filePath" alt="">
                        </div> -->
                <!-- sticker -->
                <div *ngIf="chat.status!=2 && chat.type_message==13 ">
                    <sys_animation_chat_index class="w-full h-full"
                        [file_path]="chat.filePath">
                    </sys_animation_chat_index>
                    <!-- <sys_animation_chat_index class="w-full h-full"
                        [file_path]="'assets/archive/Angry.json'">
                    </sys_animation_chat_index> -->
                </div>
                <!-- record -->
                <div *ngIf="chat.status!=2 && chat.type_message==6 ">
                    <span (click)="click_record()">
                        <div class="flex flex-row">
                            <div class="flex">
                                <mat-icon class="w-10 h-10 text-white"
                                    *ngIf="start_record==false">play_circle_filled
                                </mat-icon>
                                <mat-icon class="w-10 h-10 text-white"
                                    *ngIf="start_record==true">stop</mat-icon>
                            </div>
                            <div class="flex items-center justify-center text-center">
                                <span *ngIf="start_record==false">
                                    Bản ghi âm
                                </span>
                                <span *ngIf="start_record==true">
                                    Đang mở
                                </span>
                            </div>
                        </div>
                    </span>

                </div>
                <!-- tag meta -->
                <div *ngIf="chat.status!=2 && chat.type_message==1 && chat.meta_tag!=null">
                    <a class="text-blue-500 hover:underline"
                        href="{{change_parse_json_url(chat.meta_tag).url_raw}}">
                        {{change_parse_json_url(chat.meta_tag).url_raw}}
                    </a><br>
                    <img src="{{change_parse_json_url(chat.meta_tag).image}}" alt="">
                    <br>
                    <a class="text-blue-500 hover:underline"
                        href="{{change_parse_json_url(chat.meta_tag).url}}">
                        {{change_parse_json_url(chat.meta_tag).url}}
                    </a><br>
                    <span
                        class="font-bold">{{change_parse_json_url(chat.meta_tag).title}}</span><br>
                    <span>{{change_parse_json_url(chat.meta_tag).description}}</span>
                </div>
                <!-- message đã bị xóa -->
                <div *ngIf="chat.status==2 ">
                    <span>Tin nhắn đã bị xóa</span>
                </div>
            </div>
        </div>
        <div class="mt-4 mx-4">
            <mat-form-field class="fuse-mat-no-subscript fuse-mat-rounded fuse-mat-dense w-full"
                [floatLabel]="'always'">
                <mat-icon matPrefix class="icon-size-5" [svgIcon]="'heroicons_solid:search'"></mat-icon>
                <input matInput [autocomplete]="'off'" [placeholder]="'Tìm kiếm bạn bè'"
                    (input)="filterChats(searchField.value)" #searchField>
            </mat-form-field>
        </div>
        <div class="mt-4 mx-4" *ngIf="list_chat_chip.length">
            <mat-form-field class="fuse-mat-no-subscript fuse-mat-rounded fuse-mat-dense w-full">
                <mat-chip-list #chipList class="py-2">
                    <mat-chip class="h-10" *ngFor="let tag of list_chat_chip; let i = index" (removed)="remove_friend(i)">
                        <img style="margin-right: 5px; max-width: 20px; border-radius: inherit;" src="https://bka.edu.vn/assets/images/groupchat.png"
                            alt="">{{tag.conversation_group_name}}
                        <button matChipRemove class="mb-1">
                            <mat-icon>cancel</mat-icon>
                        </button>
                    </mat-chip>
                </mat-chip-list>
            </mat-form-field>
        </div>
        <div class="mx-4">
            <ng-container *ngIf="list_chat.length; else noContacts">
                <ng-container *ngFor="let item of list_chat; let i = index; trackBy: trackByFn">
                    <div (click)="add_friend(i)"
                        class="z-20 flex items-center px-6 py-4 md:px-8 cursor-pointer border-b hover:bg-gray-100 dark:hover:bg-hover">
                        <div class="flex flex-0 items-center justify-center w-10 h-10 rounded-full overflow-hidden">
                                 <!-- <ng-container *ngIf="item.conversation_group_image!=''">
                                            <img class="w-full h-full rounded-full object-cover" [src]="item.conversation_group_image"
                                                alt="" />
                                        </ng-container>
                                        <ng-container
                                            *ngIf="item.conversation_group_image==='' || item.conversation_group_image=== null || item.conversation_group_image=== undefined">
                                            <div
                                                class="flex items-center justify-center w-full h-full rounded-full text-lg uppercase bg-gray-200 text-gray-600 dark:bg-gray-700 dark:text-gray-200">
                                                {{item.conversation_group_name.charAt(0)}}
                                            </div>
                                        </ng-container> -->
                                        <!-- https://bka.edu.vn/assets/images/groupchat.png -->
                                        <ng-container>
                                            <img class="w-full h-full rounded-full object-cover" src="https://bka.edu.vn/assets/images/groupchat.png"
                                                alt="" />
                                        </ng-container>
                        </div>
                        <div class="min-w-0 ml-4">
                            <div class="font-medium leading-5 truncate">{{item.conversation_group_name}}</div>
                        </div>
                    </div>
                </ng-container>
            </ng-container>
        </div>
    </div>

    <!-- No contacts -->
    <ng-template #noContacts>
        <div class="p-8 sm:p-16 text-4xl font-semibold tracking-tight text-center"></div>
    </ng-template>
</div>